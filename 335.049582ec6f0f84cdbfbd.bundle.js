(()=>{"use strict";const t=Math.pow(10,5);function e(t,e){return`Group:${t}@Item:${e}`}let n=!1;addEventListener("message",(({data:o})=>{"start-simulation"===o.type?function(o,i){const r=100*t,u=i.reduce(((t,e,n)=>{var o,i;const r=null!==(i=null===(o=t.at(-1))||void 0===o?void 0:o.upperBound)&&void 0!==i?i:0;return[...t,...Array.from({length:e.quantity},((t,o)=>({itemGroupIndex:n,itemEntityIndex:o,lowerBound:r+e.normalizedProb*o,upperBound:r+e.normalizedProb*(o+1)})))]}),[]);!function t(i){i>o?postMessage({type:"done"}):function o(d,s){if(s.size>=u.length)return postMessage({type:"end-current-trial"}),void setTimeout((()=>t(i+1)),0);if(n)return n=!1,void postMessage({type:"done"});const a=Math.random()*r,p=u.find((t=>t.lowerBound<=a&&a<t.upperBound));void 0===p||s.has(e(p.itemGroupIndex,p.itemEntityIndex))||(s.add(e(p.itemGroupIndex,p.itemEntityIndex)),postMessage(((t,e,n)=>({type:"update-current-trial",detail:{itemGroupIndex:t,itemEntityIndex:e,pickCount:n}}))(p.itemGroupIndex,p.itemEntityIndex,d))),setTimeout((()=>o(d+1,s)),0)}(1,new Set)}(1)}(o.simulationCount,o.itemGroupList):"abort-simulation"===o.type&&(n=!0)}))})();